\NeedsTeXFormat{LaTeX2e}[2020/02/02]
\ProvidesPackage{latexcourse}[2024/03/05 latexcourse]

% A simple TODO command, available only when the 'draft' option is set
\DeclareOption{draft}{
    \newcommand{\todo}[1]{\textcolor{red}{\textbf{[TODO: #1]}}}
    \newcommand{\quiettodo}[1]{}
}
\ProcessOptions\relax


\RequirePackage{mathtools}
\RequirePackage{csquotes}
\RequirePackage[hidelinks]{hyperref}
\RequirePackage[capitalize]{cleveref}
\RequirePackage{xcolor}
\RequirePackage{framed}
\RequirePackage[hyperref,framed]{ntheorem}

% Remark environments have a shaded margin
\theoremstyle{nonumberbreak}
\theorembodyfont{\upshape}
\theoremprework{
    % Shade the left margin
    \renewcommand{\FrameCommand}{{\color{lightgray}{\hspace{-10pt}\vrule width 4pt\hspace{6pt}}}}
    \MakeFramed{\advance\hsize-\width \FrameRestore}
}
\theorempostwork{\endMakeFramed}
\newtheorem{latexthree}{New in \LaTeX3}[section]

\newcommand{\anothertheorem}[2]{
    \theoremclass{latexthree}
    \newtheorem{#1}[latexthree]{#2}
}
\anothertheorem{warning}{Warning}
\anothertheorem{gotcha}{Gotcha!}
\anothertheorem{overleaf}{Note to Overleaf users}
\anothertheorem{practices}{Good practices}

% There are also theorem environments for the examples; these use plain style
\newtheorem{theorem}{Theorem}

% Macros for referencing commands and environments
% These automatically add the corresponding index entries
% Here we use \NewDocumentCommand, the new method introduced in LaTeX3,
% to simplify the handling of optional arguments.
\RequirePackage{makeidx}
\NewDocumentCommand{\cmd}{o m}{\texttt{\textbackslash{}#2}\indexcmd[#1]{#2}}
\NewDocumentCommand{\indexcmd}{o m}{\index{#2@\texttt{\textbackslash{}#2}\IfValueT{#1}{!#1}}}
\NewDocumentCommand{\obscmd}{m}{\texttt{\textbackslash{}#1}\index{#1@\texttt{\textbackslash{}#1} \emph{(do not use)}}}
\NewDocumentCommand{\indexenv}{o m}{\index{#2@\texttt{#2} environment\IfValueT{#1}{!#1}}}
\NewDocumentCommand{\env}{o m}{\texttt{#2}\indexenv[#1]{#2}}
\NewDocumentCommand{\indexpkg}{o m}{\index{#2@\textsf{#2} package\IfValueT{#1}{!#1}}}
\NewDocumentCommand{\pkg}{o m}{\textsf{#2}\indexpkg[#1]{#2}}

% Code examples use the fancyvrb package.
% How this works:
%   1. Use a \begin{VerbatimOut}{\jobname.tmp} environment
%      to write the example code to a temporary file
%   2. Then call \ShowExample
%      a) It first prints the code verbatim on a minipage
%      b) And then \input's the same code for evaluation onto another minipage
\RequirePackage{fancyvrb}
\newcommand{\ShowExample}{%
    \begin{center}
    \hrulefill\\*[1em]
    \begin{minipage}{0.58\textwidth}
    \VerbatimInput[fontsize=\footnotesize]{\jobname.tmp}
    \end{minipage}
    \begin{minipage}{0.4\textwidth}
    \input{\jobname.tmp}
    \end{minipage}\\*[1em]
    \hrulefill
    \end{center}
}

% Also an environment for code examples that are not executed
\DefineVerbatimEnvironment{ExampleCode}{Verbatim}{frame=lines, framesep=1em, fontsize=\footnotesize}

\endinput

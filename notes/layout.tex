\chapter{Page layout and whitespace}


%
%
%
\section{How \TeX{} sets lines}\label{sec:overfull}\label{sec:babel}

The line and paragraph shaping algorithm of \TeX{} has long been touted as excellent.
\todo{Cite it}
The algorithm breaks lines and hyphenates words in a way that tries to
keep the inter-word spacing visually pleasing.
It works on paragraph level: changing a word may cause the preceding lines to be set differently,
as \TeX{} tries to find the globally best solution.

\begin{technote}
The algorithm has quite a few parameters that \emph{can} be modified\dots{}
but most likely \emph{should} not.
You can find them in the TeXbook \todo{cite}.
\end{technote}

\todo{Boxes}


%
%
\subsection{Hyphenation}
By default \TeX{} hyphenates words according to a set of English rules.
It is very good at hyphenating general text, and can be trusted at it.%
\footnote{As a non-native English speaker, I don't even know what the rules are.}
Sometimes, especially with technical compound words, it might still need some help.

To hint the possible breaking points, use the \cmd{-} command.
This disables automatic hyphenation for the particular word,
so it will only be broken at the hinted points.
Conversely, if a word should not be broken across lines, it can be wrapped in an \cmd{mbox}.
Finally, to prevent a line break between two words,
the \verb|~| symbol produces a \emph{non-breaking space}.

Compare these two passages (to illustrate the automatic hyphenation, they are slightly different).
The breaking override commands cause the lines to be underfull,
but at least for names the result is syntactically more correct.
%
\begin{VerbatimOut}{\jobname.tmp}
Quantum electro\-chromo\-dynamics
presented by P.~Laarne,
based on \mbox{Chatterjee}.\\

Quantum electrochromodynamics
presented by one P. Laarne,
reading about Chatterjee.
\end{VerbatimOut}
\ShowExample

\begin{practices}
If you add a hyphenation hint to a word,
I suggest adding \verb|\-| commands at all reasonable hyphenation points.
That might save you some effort when the line breaking changes.
\end{practices}

\todo{Adding words to the hyphenation dictionary}

Let us then talk about the issues.
An \emph{overfull hbox}\index{overfull} means that \TeX{} could not break the lines
without overflowing into the margin.
Conversely, an \emph{underfull hbox}\index{underfull} results from a line having too little content,
and thus unacceptably large spaces between words.
There are a few ways to fix these issues:

\begin{itemize}
    \item If the offending line is visually not too bad, just accept it.
    \item Slightly change the wording or word order to create better hyphenation opportunities.
    \item Manually tweak the hyphenation of a long word within the paragraph.
    \item If the page layout causes suboptimal paragraph shaping,
        it could also be tweaked, but this is an extreme action (see \todo{reference}).
\end{itemize}
%
There is just one hard rule:

\begin{warning}
Only fix over-/underfull issues at the very end of publication process,
when you have applied the final style file
and all the content fixes are done.

Since the \TeX{} layout algorithm is global,
adding just one letter can change the breaking of a line,
which can change the length of the paragraph,
which can change the page layout,
which then propagates to the next pages.
Result: You fixed a typo, and all the fine-tuning you had done on the following pages was just lost.

I have often seen a one-word change increase the length of a paper by half a page.
\todo{TLC production notes}
\end{warning}

By default \LaTeX{} produces justified text that extends from the left to right margin.
It is possible to let the line lengths vary (as most word processors do by default).
This is done by the \cmd{raggedright} command,
or more locally inside a \env{flushleft} environment.
%
\begin{VerbatimOut}{\jobname.tmp}
Here the text is spread evenly
between the two margins.
Spaces between words can vary a lot.\\

\raggedright

Now the lines are broken
once they no longer fit more text.
Spaces between words are more equal.
\end{VerbatimOut}
\ShowExample
%
Using ragged lines is a design decision,
and only applicable to documents where you are in control.
There seems to be quite a lot of disagreement of the merits of justified and ragged text.

I personally used ragged text in the bibliography of my MSc~thesis,
as the justification made it a mess of overfull and underfull lines.
Your mileage may vary.



%
%
\subsection{Language}

The standard method for producing \LaTeX{} documents in a language other than English,
or even in multiple languages, is the \pkg{babel} package.
It does several things:
\begin{itemize}
    \item Applies the language-specific hyphenation rules;
    \item Translates words produced by \LaTeX{} commands such as ``Chapter'', ``References'',
        and dates produced by \cmd{today};
    \item Might do some typographical fine-tuning.
\end{itemize}

The list of languages is passed as an option when \pkg{babel} is loaded.
The last language on the list is taken to be the default language for the document.
In these notes, the magic command is
%
\begin{ExampleCode}
\usepackage[finnish,french,english]{babel}
\end{ExampleCode}
%
The full list of languages (and regional variants!) can be found in the babel documentation.
Some European languages have undergone major orthography revisions in the past decades;
for modern German the language code is \verb|ngerman|
and for Norwegian nynorsk it is \verb|norsk|.

The currently active language is changed with \cmd{selectlanguage}.
The \env{otherlanguage} environment can be used for a short passage in a different language.
Below there are two visible changes:
obviously the language is different, but do note also the small space before !\ in the French version.
\indexcmd{frquote}
\begin{VerbatimOut}{\jobname.tmp}
This file was compiled on \today.
``Awesome!''\\

\begin{otherlanguage}{french}
Cet fiscier est compilé le \today.
\frquote{Voilà!}
\end{otherlanguage}
\end{VerbatimOut}
\ShowExample

The hyphenation rules are also changed,
but the effect might be negligibly small.
Overall, the hyphenation algorithm of \TeX{} is optimized for English,
so the long Finnish words might need your help.
\begin{VerbatimOut}{\jobname.tmp}
Pitkähköjen yhdyssanamuotojen tavutus
oikeinkirjoitussääntöjen mukaisesti\\

\begin{otherlanguage}{finnish}
Pitkähköjen yhdyssanamuotojen tavutus
oikeinkirjoitussääntöjen mukaisesti
\end{otherlanguage}
\end{VerbatimOut}
\ShowExample

Finally, since non-English languages also contain non-English characters,
we need to talk about font encodings.

\begin{gotcha}\label{rem:font encoding}
This here is the most important place where the traditional pdfTeX compiler
and the Unicode-native LuaTeX and XeTeX compilers differ.
You \emph{should always} use the \cmd{fontencoding} command with pdfTeX,
unless your document only contains the basic English characters.
On the other hand, you \emph{should not} use \cmd{fontencoding} with LuaLaTeX or XeLaTeX,
since they use a better internal encoding by default.

It is not dangerous to use \cmd{fontencoding} with the new compilers,
but you might get suboptimal \todo{clarify} behaviour.
\end{gotcha}

Since 2018, \LaTeX{} has accepted Unicode input by default.
However, this only applies to the input:
characters are then transformed into an internal representation
and further into individual glyphs from a font file.%
\footnote{To be precise, several characters can be combined into one glyph:
see the ffi in `efficient'.
These are called ligatures.}
When \TeX{} and \LaTeX{} were developed,
they had to solve the problem of having many (mathematical) glyphs,
but Unicode was back then far from a universal standard.

There are several of these internal representations,
and the so-called \verb|OT1| encoding is the most recent one.

The LuaTeX and XeTeX engines use Unicode for their internal representation,
so this command is no longer necessary.
Furthermore, it conflicts with \todo{what exactly},
so it should be removed altogether.

\begin{practices}
Unfortunately, most journals (and coauthors)
still use pdfLaTeX in their production process,
so you might just need to accept the minor issues with newer compilers.
\end{practices}


%
%
%
\section{Units of measure and whitespace}

\todo{Inter-word spacing}

\section{Page geometry}

\todo{Landscape pages}

\todo{needspace and page breaks}

\section{Headers and footers}

\section{Titles}
